-- @testpoint: 删除tablename表的column_1、column_2列的多列统计信息或其声明
drop table if exists analyze_002;
SQL SUCCESS
create table analyze_002(c_id int,name varchar2(10),time date ,sex varchar2(20));
SQL SUCCESS
insert into analyze_002 values(1,'mm',to_date('2018','yyyy'),'mm');
SQL SUCCESS
insert into analyze_002 values(2,'m',to_date('2018','yyyy'),'m');
SQL SUCCESS
insert into analyze_002 values(3,'mmmm',to_date('2018','yyyy'),'mmmmmm');
SQL SUCCESS
select * from analyze_002 order by c_id;
+------+------+-------------------------------+--------+
| c_id | name | time                          | sex    |
+------+------+-------------------------------+--------+
| 1    | mm   | 2018-01-01 00:00:00.000000000 | mm     |
| 2    | m    | 2018-01-01 00:00:00.000000000 | m      |
| 3    | mmmm | 2018-01-01 00:00:00.000000000 | mmmmmm |
+------+------+-------------------------------+--------+
analyze analyze_002  ((c_id, name));
SQL SUCCESS
select * from pg_statistic where starelid = (select oid from pg_class where relname = 'analyze_002');
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+------------+------------+------------+------------+------------+---------------+------------+
| starelid | starelkind | staattnum | stainherit | stanullfrac | stawidth | stadistinct | stakind1 | stakind2 | stakind3 | stakind4 | stakind5 | staop1 | staop2 | staop3 | staop4 | staop5 | stanumbers1 | stanumbers2 | stanumbers3 | stanumbers4 | stanumbers5 | stavalues1 | stavalues2 | stavalues3 | stavalues4 | stavalues5 | stadndistinct | staextinfo |
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+------------+------------+------------+------------+------------+---------------+------------+
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+------------+------------+------------+------------+------------+---------------+------------+
alter table  analyze_002 add statistics ((c_id, name));
SQL SUCCESS
analyze analyze_002;
SQL SUCCESS
select * from pg_statistic where starelid = (select oid from pg_class where relname = 'analyze_002');
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+-------------------------+------------+------------+------------+------------+---------------+------------+
| starelid | starelkind | staattnum | stainherit | stanullfrac | stawidth | stadistinct | stakind1 | stakind2 | stakind3 | stakind4 | stakind5 | staop1 | staop2 | staop3 | staop4 | staop5 | stanumbers1 | stanumbers2 | stanumbers3 | stanumbers4 | stanumbers5 | stavalues1              | stavalues2 | stavalues3 | stavalues4 | stavalues5 | stadndistinct | staextinfo |
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+-------------------------+------------+------------+------------+------------+---------------+------------+
?.*| c          | 1         | false      | 0.0         | 4        | -1.0        | 2        | 3        | 0        | 0        | 0        | 97     | 97     | 0      | 0      | 0      |             | \{1.0\}       |             |             |             | \{1,2,3\}                 |            |            |            |            | 0.0           |            |
?.*| c          | 2         | false      | 0.0         | 3        | -1.0        | 2        | 3        | 0        | 0        | 0        | 664    | 664    | 0      | 0      | 0      |             | \{0.5\}       |             |             |             | \{m,mm,mmmm\}             |            |            |            |            | 0.0           |            |
?.*| c          | 3         | false      | 0.0         | 8        | -0.33333334 | 1        | 3        | 0        | 0        | 0        | 2060   | 2062   | 0      | 0      | 0      | \{1.0\}     | \{1.0\}       |             |             |             | \{"2018-01-01 00:00:00"\} |            |            |            |            | 0.0           |            |
?.*| c          | 4         | false      | 0.0         | 4        | -1.0        | 2        | 3        | 0        | 0        | 0        | 664    | 664    | 0      | 0      | 0      |             | \{0.5\}       |             |             |             | \{m,mm,mmmmmm\}           |            |            |            |            | 0.0           |            |
+----------+------------+-----------+------------+-------------+----------+-------------+----------+----------+----------+----------+----------+--------+--------+--------+--------+--------+-------------+-------------+-------------+-------------+-------------+-------------------------+------------+------------+------------+------------+---------------+------------+
alter table   analyze_002 delete statistics ((c_id, name));
SQL SUCCESS
select c_id,name from analyze_002 order by c_id;
+------+------+
| c_id | name |
+------+------+
| 1    | mm   |
| 2    | m    |
| 3    | mmmm |
+------+------+
drop table if exists analyze_002;
SQL SUCCESS
